<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title>Mastermind</title>
    <link rel="stylesheet" href="https://unpkg.com/purecss@1.0.0/build/pure-min.css" integrity="sha384-nn4HPE8lTHyVtfCBi5yW9d20FjT8BJwUXyWZT9InLYax14RDjBj46LmSztkmNP9w"
        crossorigin="anonymous">
    <style type="text/css">
        body {
            background-color: #2f3136;
        }

        .gametable {
            width: 250px;
            margin-left: auto;
            margin-right: auto;
            border: 2px solid #ffffff;
        }

        .buttons {
            text-align: center;
        }

        .balltable {
            width: 100%;
        }

        .ballcell {
            margin-left: auto;
            margin-right: auto;
        }

        td {
            border: 2px solid #ffffff;
        }

        .feedbackimg {
            width: 20px;
        }

        .guessimg {
            width: 100%;
        }

        .check-button {
            color: #ffffff;
            background: rgb(28, 184, 65);
        }

        .delete-button {
            color: #ffffff;
            background: rgb(202, 60, 60);
        }

        .textfield {
            text-align: center;
            color: #ffffff;
            height: 68px;
        }
    </style>
</head>

<body>
    <p style="text-align: center"><img src="img/logo.png"></p>
    <table class="gametable">
        <tbody>
            <tr>
                <td style="width: 15px;" rowspan=2 colspan=2><img src="img/egglessomelette.png" class="guessimg" id="guess2-0"></td>
                <td style="width: 15px;" rowspan=2 colspan=2><img src="img/egglessomelette.png" class="guessimg" id="guess2-1"></td>
                <td style="width: 15px;" rowspan=2 colspan=2><img src="img/egglessomelette.png" class="guessimg" id="guess2-2"></td>
                <td style="width: 15px;" rowspan=2 colspan=2><img src="img/egglessomelette.png" class="guessimg" id="guess2-3"></td>
                <td style="width: 15px;"><img src="img/egglessomelette.png" class="feedbackimg" id="fb2-0"></td>
                <td style="width: 15px;"><img src="img/egglessomelette.png" class="feedbackimg" id="fb2-1"></td>
            </tr>
            <tr>
                <td style="width: 15px;"><img src="img/egglessomelette.png" class="feedbackimg" id="fb2-2"></td>
                <td style="width: 15px;"><img src="img/egglessomelette.png" class="feedbackimg" id="fb2-3"></td>
            </tr>
            <tr>
                <td style="width: 15px;" rowspan=2 colspan=2><img src="img/egglessomelette.png" class="guessimg" id="guess1-0"></td>
                <td style="width: 15px;" rowspan=2 colspan=2><img src="img/egglessomelette.png" class="guessimg" id="guess1-1"></td>
                <td style="width: 15px;" rowspan=2 colspan=2><img src="img/egglessomelette.png" class="guessimg" id="guess1-2"></td>
                <td style="width: 15px;" rowspan=2 colspan=2><img src="img/egglessomelette.png" class="guessimg" id="guess1-3"></td>
                <td style="width: 15px;"><img src="img/egglessomelette.png" class="feedbackimg" id="fb1-0"></td>
                <td style="width: 15px;"><img src="img/egglessomelette.png" class="feedbackimg" id="fb1-1"></td>
            </tr>
            <tr>
                <td style="width: 15px;"><img src="img/egglessomelette.png" class="feedbackimg" id="fb1-2"></td>
                <td style="width: 15px;"><img src="img/egglessomelette.png" class="feedbackimg" id="fb1-3"></td>
            </tr>
            <tr>
                <td colspan=10 style="border:none">
                    <table class="balltable">
                        <tbody>
                            <tr>
                                <td class="ballcell"><img onClick="addBall(1)" src="img/ball1.png" style="width: 100%"></td>
                                <td class="ballcell"><img onClick="addBall(2)" src="img/ball2.png" style="width: 100%"></td>
                                <td class="ballcell"><img onClick="addBall(3)" src="img/ball3.png" style="width: 100%"></td>
                                <td class="ballcell"><img onClick="addBall(4)" src="img/ball4.png" style="width: 100%"></td>
                                <td class="ballcell"><img onClick="addBall(5)" src="img/ball5.png" style="width: 100%"></td>
                                <td class="ballcell"><img onClick="addBall(6)" src="img/ball6.png" style="width: 100%"></td>
                            </tr>
                        </tbody>
                    </table>
                </td>
            </tr>
            <tr>
                <td colspan=10 class="buttons">
                    <button class="pure-button check-button">Check</button>
                    <button onClick="removeBall()" class="pure-button delete-button">Delete</button>
                </td>
            </tr>
            <tr>
                <td colspan=10 class="buttons">
                    <button class="pure-button pure-button-primary">New Game</button>
                    <button class="pure-button pure-button-primary">Instructions</button>
                </td>
            </tr>
            <tr>
                <td colspan=10 class="textfield">
                    <p id="textfield">&nbsp;</p>
                </td>
            </tr>
        </tbody>
    </table>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js" type="text/javascript"></script>
    <script src="http://ajax.googleapis.com/ajax/libs/prototype/1.7.1.0/prototype.js" type="text/javascript"></script>
    <script>
        
        // var game = function (gameID) {
        //     this.id = gameID;
        //     this.solution = [1, 2, 3, 4];
        //     this.guess = [0, 0, 0, 0];
        //     this.amountOfBalls = 0;
        //     this.attempt = 1;
        // }


        var solution = [1, 2, 3, 4];
        var guess = [0, 0, 0, 0];
        var amountOfBalls = 0;
        var attempt = 1;

        // game.prototype.addBall(id) {

        function addBall(id) {
            if (amountOfBalls < 4) {
                var filename = "img/ball" + id + ".png";
                var cell = "guess" + attempt + "-" + amountOfBalls;
                // $("#guess1-0").attr("src","img/ball1.png");
                document.getElementById(cell).src=filename;
                guess[amountOfBalls] = id;
                amountOfBalls++;
            } else sout("Can't add another ball: row is already full");
        }

        function removeBall() {
            if (amountOfBalls > 0) {
                amountOfBalls--;
                guess[amountOfBalls] = 0;

                var cell = "guess" + attempt + "-" + amountOfBalls;
                document.getElementById(cell).src="img/egglessomelette.png";
                // todo: edit image in html
            } else sout("Can't remove ball: there are no balls in the row")
        }

        // game.prototype.check = function() {
        function check() {
            if (this.solution == this.guess) {
                // todo: in html, change all cells to black balls
                return true;
            }
            var solutionClone = [0, 0, 0, 0];//todo: clone solution into this https://www.npmjs.com/package/clone
            var res = [0, 0, 0, 0];
            resIndex = 0;
            // 1 black: right color, right position
            for (var i = 0; i < 4; i++) {
                if (solutionClone[i] == this.guess[i] && solutionClone[i] != 0) {
                    res[resIndex++] = 1;
                    solutionClone[i] = 0;
                    guess[i] = 0;
                }
            }
            // 2 white: right color, wrong position
            for (var i = 0; i < 4; i++) {
                if (solutionClone[i] != 0) {
                    for (var j = 0; j < 4; j++) {
                        if (guess[j] != 0 && solutionClone[i] == guess[j]) {
                            solutionClone[i] = 0;
                            guess[j] = 0;
                            res[resIndex++] = 2;
                        }
                    }
                }
            }
            // todo: display res in html
            attempt++;
            return false;
        }

        function sout(string) {
            document.getElementById("textfield").innerText=string;
            setTimeout(function() {
                document.getElementById("textfield").innerText=" ";
            }, 2000);
        }

        // module.exports = game;
    </script>
</body>

</html>